<!doctype html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
        <title> Identicum </title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
        <style>
            .code-content td {
                font-size: 0.9em;
            }
            .bold {
                font-weight: 600;
            }
            footer {
                bottom: 0;
                position: fixed;
                width: 100%;
                font-size: 14px;
                line-height: 40px;
                background-color: white;
                opacity: 0.6;
            }
            footer a {
                color: #000;
            }
        </style>
    </head>
    <body>
        <nav class='navbar navbar-expand-lg navbar-light bg-light'>
            <div class='container'>
                <a class='navbar-brand' href='/ipax'>
                    <img src='/img/logo.png' height='40' alt=''>
                </a>
                <ul class='nav navbar-nav navbar-logo mx-auto'>
                    <li class='nav-item'>
                        <a class='nav-link' href='#'>IPAx info page</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class='container' style='margin-top: 20px'>
            <div class='row'>
                <div class='col-3'>
                    <div class='nav flex-column nav-pills' id='v-pills-tab' role='tablist' aria-orientation='vertical'>
                        <button class='nav-link text-start active' id='v-pills-id-token-tab' data-bs-toggle="pill" data-bs-target='#v-pills-id-token' type="button" role='tab' aria-controls='v-pills-id-token' aria-selected='true'>ID token Claims</button>
                        <button class='nav-link text-start' id='v-pills-access-token-tab' data-bs-toggle="pill" data-bs-target='#v-pills-access-token' type="button" role='tab' aria-controls='v-pills-access-token' aria-selected='true'>Access token</button>
                        <button class='nav-link text-start' id='v-pills-userinfo-claims-tab' data-bs-toggle="pill" data-bs-target='#v-pills-userinfo-claims' type="button" role='tab' aria-controls='v-pills-userinfo-claims' aria-selected='true'>Userinfo Claims</button>
                        <button class='nav-link text-start' id='v-pills-userinfo-json-tab' data-bs-toggle="pill" data-bs-target='#v-pills-userinfo-json' type="button" role='tab' aria-controls='v-pills-userinfo-json' aria-selected='true'>Userinfo JSON</button>
                        <button class='nav-link text-start' id='v-pills-http-headers-tab' data-bs-toggle="pill" data-bs-target='#v-pills-http-headers' type="button" role='tab' aria-controls='v-pills-http-headers' aria-selected='true'>HTTP headers</button>
                    </div>
                </div>
                <div class='col-9'>
                    <div class='tab-content' id='v-pills-tabContent'>
                        <div class='tab-pane fade show active' id='v-pills-id-token' role='tabpanel' aria-labelledby='v-pills-id-token-tab'>
                            <table class='table table-striped code-content'>
                                <thead>
                                    <tr>
                                        <th>ID token</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% -- print('Processing id_token claims') %}
                                    {% for k, v in pairs(id_token) do %}
                                    {% -- print('Processing id_token claim: ' .. k .. ' = ' .. tostring(v)) %}
                                        <tr><td>{{k}}</td><td class='bold'>{{tostring(v)}}</td></tr>
                                    {% end %}
                                </tbody>
                                </table>
                        </div>
                        <div class='tab-pane fade show' id='v-pills-access-token' role='tabpanel' aria-labelledby='v-pills-access-token-tab'>
                            <table class='table table-striped code-content'>
                                <thead>
                                    <tr>
                                        <th>Access token</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td style='word-break:break-word;white-space:pre-wrap;-moz-white-space:pre-wrap;'>{{access_token}}</td></tr>
                                    <tr><td><a href='https://jwt.io/?value="{{access_token}}"' target='_blank'>View in https://jwt.io/</a></td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class='tab-pane fade show' id='v-pills-userinfo-claims' role='tabpanel' aria-labelledby='v-pills-userinfo-claims-tab'>
                            <table class='table table-striped code-content'>
                                <thead>
                                    <tr>
                                        <th>Claim</th>
                                        <th>Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% -- print('Processing userinfo claims') %}
                                    {% for k, v in pairs(user) do %}
                                    {% -- print('Processing userinfo claim: ' .. k .. ' = ' .. tostring(v)) %}
                                        <tr><td>{{k}}</td><td class='bold'>{{tostring(v)}}</td></tr>
                                    {% end %}
                                </tbody>
                            </table>
                        </div>
                        <div class='tab-pane fade show' id='v-pills-userinfo-json' role='tabpanel' aria-labelledby='v-pills-userinfo-json-tab'>
                            <table class='table table-striped code-content'>
                                <thead>
                                    <tr>
                                        <th>Userinfo JSON</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td style='word-break:break-word;white-space:pre-wrap;-moz-white-space:pre-wrap;' id="userinfojson"></td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class='tab-pane fade show' id='v-pills-http-headers' role='tabpanel' aria-labelledby='v-pills-http-headers-tab'>
                            <table class='table table-striped code-content'>
                                <thead>
                                    <tr>
                                        <th>Header</th>
                                        <th>Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% -- print('Processing headers') %}
                                    {% for k, v in pairs(headers) do %}
                                    {% -- print('Processing header: ' .. k .. ' = ' .. tostring(v)); %}
                                        <tr><td>{{k}}</td><td class='bold'>{{tostring(v)}}</td></tr>
                                    {% end %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class='text-center'>
            <a href='https://www.identicum.com'>&copy; Identicum</a> |
            <a href='https://github.com/identicum/ipax'><i class='fab fa-github'></i> Github</a>
        </footer>
        <script type="application/javascript">
            window.onload = function(){
                const userinfo = JSON.parse('{{userinfo_json}}'.replace(/&quot;/g,'"'));
                document.getElementById("userinfojson").innerHTML = JSON.stringify(userinfo, null, "\t");
            }
        </script>
    </body>
</html>
